<!DOCTYPE html>
<html class="" lang="en"><head>
    
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=7" />

    <link
    rel="icon"
    href='/favicon.png'
/>
<link
    rel="shortcut icon"
    href='/favicon.ico'
    type="image/x-icon"
/>
<link
    rel="apple-touch-icon"
    href='/apple-touch-icon.png'
/>

<title>
        
            Importing Functions, Classes, and Methods From Other PowerShell Files  &ndash;
        
        LoopedNetwork
    </title>

    
    <link href="/symbols-nerd-font/symbols-nerd-font.css" rel="stylesheet" integrity="sha512-lydow8GLOLlYNOtHlksNCmGWWCBsbIEtikXpHzfWqx78HLlyQZHOzyLwPpKol4Th6aCwLUXOfODVYgwrd3nwKQ=="/>
    <link href="/jetbrains-mono/jetbrains-mono.css" rel="stylesheet" integrity="sha512-tJxlgL6v1Y7kFf+qB8SloaAMKnOAw6WouknxXtIjkBux9Y/9aX81EUWOJO8c/3l98DmjG8brr4to7zaez606Fg=="/>

    
    
    <link type="text/css" rel="stylesheet" href=https://looped.network/css/styles.abbd6311bb4b6ca58f8e7398140529245ae0f6428b759fcd830742eee2619eabb900ba9914a9affb82aa9a16a9b9ea727bb315315a976a0db0e7513a5f12c504.css integrity="sha512-q71jEbtLbKWPjnOYFAUpJFrg9kKLdZ/NgwdC7uJhnqu5ALqZFKmv&#43;4Kqmhapuepye7MVMVqXag2w51E6XxLFBA==" />
<meta name="author" content="LoopedNetwork" />

    
        <meta name="keywords" content='Module, PowerShell' />
    
    
        <meta name="description" content="been working on a project that requires me to use PowerShell. I actually feel relatively fluent in PowerShell since it was my main scripting language for a little over a decade while I worked as a sysadmin in highly Windows-centric environments that involved me automating as much of my job as possible in order to be able to do things like sleep on occasion. However, my PowerShell work rarely (read: never) went beyond single file scripts." />
    

<meta property="og:site_name"
    content='LoopedNetwork' />

    <meta property="og:title" content="Importing Functions, Classes, and Methods From Other PowerShell Files" />
    <meta property="og:type" content="article" />
    
    <meta
        property="article:author" content="LoopedNetwork" />
    <meta
        property="article:published_time"
        content='2022-07-31T18:20:36Z-0400' />
    
        
            <meta property="article:tag" content="Module" />
        
            <meta property="article:tag" content="PowerShell" />
        
    
    <meta property="og:url" content="https://looped.network/posts/powershell-import-classes-functions/" />
    
    
    <meta property="og:image"
        content="https://looped.network/img/icon.svg" />
    
        <meta property="og:description" content="I&amp;rsquo;ve recently been working on a project that requires me to use PowerShell. I actually feel relatively fluent in PowerShell since it was my main scripting" />
    

<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:domain"
      content='looped.network'
/>
<meta property="twitter:url" content="https://looped.network/posts/powershell-import-classes-functions/" />


    <meta name="twitter:title" content="Importing Functions, Classes, and Methods From Other PowerShell Files" />
    
    
    
    <meta name="twitter:image"
        content="https://looped.network/img/icon.svg" />
    
        <meta name="twitter:description" content="I&amp;rsquo;ve recently been working on a project that requires me to use PowerShell. I actually feel relatively fluent in PowerShell since it was my main scripting" />
    

<link rel="manifest" href="/manifest/index.json" />
</head>


<body>
        <div id="baseContainer"><header class="">
<div class="titleAndSearchContainer">
        <div id="titleContainer">
            
                <a class="unstyledLink" href="/">
                    <img src='/logo.svg' alt='Logo'/>
                </a>
            
            <div class="rightOfLogo">
                <div class="titleAndHamburger">
                    <h1>
                        <a class="unstyledLink" href="/">LoopedNetwork</a>
                        
                    </h1>
                    
                </div>
                <div id="wide_nav"><nav>
    
    <ul id="main-nav">
        <li><a href="/">Home</a></li>
        
            <li><a href="/posts">Posts</a></li>
        
        
        
        
        
            <li><a href="https://looped.network/pages/about/">
                About
            </a></li>
        
        
            <li><a href="/about/">About</a></li>
        
        
            <li><a href="/tags">Tags</a></li>
        
        
    </ul>
</nav>
</div>
            </div>
        </div>
        <div class="search">
    <input id="searchbar" type="text" placeholder='Search' />
    <a class="nerdlink" onclick="newSearch();">&#xf002;</a>
</div>
<script>
    function newSearch() {
        let term = searchbar.value.trim();
        if (!term) return;
        location.href = `/search?q=${term}`;
    }
    searchbar.onkeyup = (ev) => {if (ev.keyCode == 13) newSearch()};
</script>

    </div>
    <div id="links">
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="/index.xml">
    
    
        &#xf09e;
    
    <span>
        RSS
    </span>
</a>

        
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://github.com/jfabry-noc">
    
    
        &#xf09b;
    
    <span>
        GitHub
    </span>
</a>
<a
    
        rel="me"
    
    target="_blank"
    class="nerdlink"
    href="https://mastodon.online/@looped_network">
    
    
        <svg class='pseudofont' xmlns:svg='http://www.w3.org/2000/svg' width='16' height='16' viewbox='0 0 16 16'><path d='M 7.4779094,-1.598624e-6 C 5.5602384,0.0156984 3.7155894,0.2233384 2.6405814,0.7170384 c 0,0 -2.13206093,0.9537 -2.13206093,4.20766 0,0.74512 -0.01448,1.63603 0.0091,2.58084 0.07742,3.1821946 0.58336693,6.3183886 3.52553593,7.0971276 1.356568,0.359063 2.521335,0.434289 3.45936,0.382729 1.701085,-0.09431 2.6560206,-0.607063 2.6560206,-0.607063 l -0.05611,-1.234252 c 0,0 -1.2156316,0.383272 -2.5808476,0.33656 -1.352609,-0.04639 -2.780561,-0.145832 -2.999328,-1.80651 -0.0202,-0.145872 -0.03031,-0.301902 -0.03031,-0.465714 0,-10e-7 1.327834,0.324572 3.010574,0.40167 1.028943,0.0472 1.993827,-0.06028 2.9738766,-0.177218 1.879445,-0.224425 3.515901,-1.382448 3.721577,-2.4405646 0.32407,-1.666815 0.297376,-4.067605 0.297376,-4.067605 0,-3.25396 -2.131943,-4.20766 -2.131943,-4.20766 C 11.288476,0.2233384 9.4426784,0.0156784 7.5250084,-1.598624e-6 Z M 5.3076104,2.5424984 c 0.798781,0 1.403595,0.30701 1.803551,0.92113 l 0.388886,0.65181 0.388884,-0.65181 c 0.399875,-0.61412 1.00469,-0.92113 1.803551,-0.92113 0.6903266,0 1.2465526,0.24267 1.6713186,0.71609 0.411755,0.47342 0.61677,1.11337 0.61677,1.91862 v 3.939988 h -1.560986 v -3.824218 c 0,-0.80613 -0.339166,-1.21531 -1.0176126,-1.21531 -0.750129,0 -1.126049,0.48533 -1.126049,1.44509 v 2.09324 h -1.551753 v -2.09324 c 0,-0.95976 -0.376039,-1.44509 -1.126168,-1.44509 -0.678446,0 -1.017613,0.40918 -1.017613,1.21531 v 3.824218 h -1.560985 v -3.939988 c 0,-0.80525 0.205053,-1.4452 0.616889,-1.91862 0.424685,-0.47342 0.980911,-0.71609 1.671317,-0.71609 z' /></svg>
    
    <span>
        Mastodon
    </span>
</a>

    </div>
    

</header>
<div id="contentContainer">
                <div id="content">
                    <main>
<article class="card single">
    
        <h1>Importing Functions, Classes, and Methods From Other PowerShell Files</h1>
    
    
        <p class="date">
            <span title='Date'>ï—¬ </span>
    2022-07-31

</p>
    
    
    
    
    <div><p>I&rsquo;ve recently been working on a project that requires me to use PowerShell. I actually feel relatively fluent in PowerShell since it was my main scripting language for a little over a decade while I worked as a sysadmin in highly Windows-centric environments that involved me automating as much of my job as possible in order to be able to do things like sleep on occasion. However, my PowerShell work rarely (read: never) went beyond single file scripts.</p>
<p>With this project being a decent bit more complicated and with the potential for some of the code to be useful in future projects, I wanted to figure out how to actually break things up into useful chunks, just like I would do when writing something in Python. Fortunately, it wasn&rsquo;t terribly difficult to figure out, though, as is typically the case with PowerShell, the documentation was a bit wanting. I had to put information together from a few different resource and go through a little trial-and-error to actually figure it out since Microsoft can never just seem to give clear, concise examples of anything PowerShell-related.</p>
<p>The first thing I needed to realize is that I wanted to create my files not with a normal <code>.ps1</code> extension but with a <code>.psm1</code> extension to indicate that they were PowerShell modules. Only the file that would normally be executed directly has a <code>.ps1</code> extension. I kind of hate this since it makes things more difficult to test individually; in Python, for example, I could just create a main function that executes when:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span></code></pre></div><p>Then I can add things in <code>main</code> while building it out that are later ignored when the code is called from elsewhere. PowerShell doesn&rsquo;t offer anything like this, though it&rsquo;s not a huge ordeal. After creating a <code>.psm1</code> file, it can contain functions, classes, and/or methods. For example, here&rsquo;s a sample file called <code>helloFunc.psm1</code> with just a function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Write-Hello {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">param</span>(
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">Parameter</span>(<span style="color:#66d9ef">Mandatory</span>=$true)]<span style="color:#66d9ef">[string]</span>$Name
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Write-Output <span style="color:#e6db74">&#34;Hello, $Name.&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And here&rsquo;s a file called <code>personClass.psm1</code> with both a class and a couple of methods:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>class Person {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">[String]</span>$Name
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">[int]</span>$Age
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Constructor.</span>
</span></span><span style="display:flex;"><span>    Person(<span style="color:#66d9ef">[String]</span>$Name, <span style="color:#66d9ef">[int]</span>$Age) {
</span></span><span style="display:flex;"><span>        $this.Name = $Name
</span></span><span style="display:flex;"><span>        $this.Age = $Age
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">[String]</span>GreetPerson(<span style="color:#66d9ef">[String]</span>$PreferredGreeting) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>($PreferredGreeting <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">-or</span> $null <span style="color:#f92672">-eq</span> $PreferredGreeting) {
</span></span><span style="display:flex;"><span>            $PreferredGreeting = <span style="color:#e6db74">&#34;Hello&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;$PreferredGreeting, </span>$($this.Name)<span style="color:#e6db74">. I can&#39;t believe you&#39;re </span>$($this.Age)<span style="color:#e6db74"> years old.&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">[void]</span>HaveBirthday() {
</span></span><span style="display:flex;"><span>        $this.Age++
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Neither file has an entrypoint, though that&rsquo;s expected since they&rsquo;re designed to be called from somewhere else. Here&rsquo;s the <code>main.ps1</code> file which ties them all together:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env pwsh</span>
</span></span><span style="display:flex;"><span>using module ./personClass.psm1
</span></span><span style="display:flex;"><span>using module ./helloFunc.psm1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Write-Hello -Name <span style="color:#e6db74">&#34;Garrett&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$me = <span style="color:#66d9ef">[Person]</span>::new(<span style="color:#e6db74">&#34;Garrett&#34;</span>, 9000)
</span></span><span style="display:flex;"><span>Write-Output $me.GreetPerson(<span style="color:#e6db74">&#34;Salutations&#34;</span>)
</span></span><span style="display:flex;"><span>$me.HaveBirthday()
</span></span><span style="display:flex;"><span>Write-Output $me.GreetPerson(<span style="color:#e6db74">&#34;Salutations&#34;</span>)
</span></span></code></pre></div><p>The most important thing here are the two <code>using</code> statements, which specify that I&rsquo;m going to import the two aforementioned files. Once I do this, I can then call classes, methods, and functions in those files directly.</p>
</div>
</article>

    <hr />
    <p class="articleTagsContainer">
        <span>ï€« </span>
        <strong>Tags:</strong>
        
            <a
                
                href="/tags/module">#Module</a>
        
            <a
                
                href="/tags/powershell">#PowerShell</a>
        
    </p>






                    </main><footer>
    <hr />

<p><small>
        2023 &copy; Copyright 2023 - LoopedNetwork
    </small></p>
    <p><small>
        <a href='https://gitlab.com/gabmus/hugo-ficurinia'>Ficurinia theme</a> for <a href='https://gohugo.io'>Hugo</a> by <a href='https://gabmus.org'>Gabriele Musco</a>. Licensed under <a href='https://www.gnu.org/licenses/agpl-3.0.html'>GNU AGPLv3</a>.
    </small></p>
</footer>
</div>
            </div>
        </div>


</body>
</html>
