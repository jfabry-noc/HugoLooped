<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Importing Functions, Classes, and Methods From Other PowerShell Files :: LoopedNetwork</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="I&amp;rsquo;ve recently been working on a project that requires me to use PowerShell. I actually feel relatively fluent in PowerShell since it was my main scripting language for a little over a decade while I worked as a sysadmin in highly Windows-centric environments that involved me automating as much of my job as possible in order to be able to do things like sleep on occasion. However, my PowerShell work rarely (read: never) went beyond single file scripts." />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://looped.network/posts/powershell-import-classes-functions/" />






  
  
  
  
  
  <link rel="stylesheet" href="https://looped.network/styles.css">







  <link rel="shortcut icon" href="https://looped.network/favicon.ico">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Importing Functions, Classes, and Methods From Other PowerShell Files">
<meta property="og:description" content="I&amp;rsquo;ve recently been working on a project that requires me to use PowerShell. I actually feel relatively fluent in PowerShell since it was my main scripting language for a little over a decade while I worked as a sysadmin in highly Windows-centric environments that involved me automating as much of my job as possible in order to be able to do things like sleep on occasion. However, my PowerShell work rarely (read: never) went beyond single file scripts." />
<meta property="og:url" content="https://looped.network/posts/powershell-import-classes-functions/" />
<meta property="og:site_name" content="LoopedNetwork" />

  
    <meta property="og:image" content="https://looped.network/favicon.ico">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2022-07-31 18:20:36 -0400 EDT" />












</head>
<body class="pink">


<div class="container headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    LoopedNetwork
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://looped.network/posts/powershell-import-classes-functions/">Importing Functions, Classes, and Methods From Other PowerShell Files</a>
  </h1>
  <div class="post-meta">
    
      <time class="post-date">
        2022-07-31 ::
        
      </time>
    
    
    
      <span class="post-reading-time">:: 3 min read (474 words)</span>
    
  </div>

  
    <span class="post-tags">
      
      #<a href="https://looped.network/tags/powershell/">PowerShell</a>&nbsp;
      
      #<a href="https://looped.network/tags/module/">Module</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>I&rsquo;ve recently been working on a project that requires me to use PowerShell. I actually feel relatively fluent in PowerShell since it was my main scripting language for a little over a decade while I worked as a sysadmin in highly Windows-centric environments that involved me automating as much of my job as possible in order to be able to do things like sleep on occasion. However, my PowerShell work rarely (read: never) went beyond single file scripts.</p>
<p>With this project being a decent bit more complicated and with the potential for some of the code to be useful in future projects, I wanted to figure out how to actually break things up into useful chunks, just like I would do when writing something in Python. Fortunately, it wasn&rsquo;t terribly difficult to figure out, though, as is typically the case with PowerShell, the documentation was a bit wanting. I had to put information together from a few different resource and go through a little trial-and-error to actually figure it out since Microsoft can never just seem to give clear, concise examples of anything PowerShell-related.</p>
<p>The first thing I needed to realize is that I wanted to create my files not with a normal <code>.ps1</code> extension but with a <code>.psm1</code> extension to indicate that they were PowerShell modules. Only the file that would normally be executed directly has a <code>.ps1</code> extension. I kind of hate this since it makes things more difficult to test individually; in Python, for example, I could just create a main function that executes when:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span></code></pre></div><p>Then I can add things in <code>main</code> while building it out that are later ignored when the code is called from elsewhere. PowerShell doesn&rsquo;t offer anything like this, though it&rsquo;s not a huge ordeal. After creating a <code>.psm1</code> file, it can contain functions, classes, and/or methods. For example, here&rsquo;s a sample file called <code>helloFunc.psm1</code> with just a function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Write-Hello {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">param</span>(
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">Parameter</span>(<span style="color:#66d9ef">Mandatory</span>=$true)]<span style="color:#66d9ef">[string]</span>$Name
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Write-Output <span style="color:#e6db74">&#34;Hello, $Name.&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And here&rsquo;s a file called <code>personClass.psm1</code> with both a class and a couple of methods:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>class Person {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">[String]</span>$Name
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">[int]</span>$Age
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Constructor.</span>
</span></span><span style="display:flex;"><span>    Person(<span style="color:#66d9ef">[String]</span>$Name, <span style="color:#66d9ef">[int]</span>$Age) {
</span></span><span style="display:flex;"><span>        $this.Name = $Name
</span></span><span style="display:flex;"><span>        $this.Age = $Age
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">[String]</span>GreetPerson(<span style="color:#66d9ef">[String]</span>$PreferredGreeting) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>($PreferredGreeting <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">-or</span> $null <span style="color:#f92672">-eq</span> $PreferredGreeting) {
</span></span><span style="display:flex;"><span>            $PreferredGreeting = <span style="color:#e6db74">&#34;Hello&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;$PreferredGreeting, </span>$($this.Name)<span style="color:#e6db74">. I can&#39;t believe you&#39;re </span>$($this.Age)<span style="color:#e6db74"> years old.&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">[void]</span>HaveBirthday() {
</span></span><span style="display:flex;"><span>        $this.Age++
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Neither file has an entrypoint, though that&rsquo;s expected since they&rsquo;re designed to be called from somewhere else. Here&rsquo;s the <code>main.ps1</code> file which ties them all together:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env pwsh</span>
</span></span><span style="display:flex;"><span>using module ./personClass.psm1
</span></span><span style="display:flex;"><span>using module ./helloFunc.psm1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Write-Hello -Name <span style="color:#e6db74">&#34;Garrett&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$me = <span style="color:#66d9ef">[Person]</span>::new(<span style="color:#e6db74">&#34;Garrett&#34;</span>, 9000)
</span></span><span style="display:flex;"><span>Write-Output $me.GreetPerson(<span style="color:#e6db74">&#34;Salutations&#34;</span>)
</span></span><span style="display:flex;"><span>$me.HaveBirthday()
</span></span><span style="display:flex;"><span>Write-Output $me.GreetPerson(<span style="color:#e6db74">&#34;Salutations&#34;</span>)
</span></span></code></pre></div><p>The most important thing here are the two <code>using</code> statements, which specify that I&rsquo;m going to import the two aforementioned files. Once I do this, I can then call classes, methods, and functions in those files directly.</p>

      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="https://looped.network/posts/gss-ntlmssp-alpine/">
                <span class="button__icon">←</span>
                <span class="button__text">Compiling GSS-NTLMSSP For Alpine Linux</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="https://looped.network/posts/terraform-cloud-variables/">
                <span class="button__text">Terraform Cloud Variables Are All Strings</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2023 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
