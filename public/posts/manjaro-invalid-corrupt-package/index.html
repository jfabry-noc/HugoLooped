<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Fixing Manjaro Linux Invalid Or Corrupt Package Error :: LoopedNetwork</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="As the title alludes to, this morning I tried updating my Pinebook Pro running Manjaro Linux through my normal method:
sudo pacman -Syu Today, this resulted in an error message about the libibus package:
 warning: could not fully load metadata for package libibus-1.5.26-2 error: failed to prepare transaction (invalid or corrupted package)
 Fun. I first wanted to see if it was really just this package that was causing the problem or if there were other issues." />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://looped.network/posts/manjaro-invalid-corrupt-package/" />






  
  
  
  
  
  <link rel="stylesheet" href="https://looped.network/styles.css">







  <link rel="shortcut icon" href="https://looped.network/favicon.ico">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Fixing Manjaro Linux Invalid Or Corrupt Package Error">
<meta property="og:description" content="As the title alludes to, this morning I tried updating my Pinebook Pro running Manjaro Linux through my normal method:
sudo pacman -Syu Today, this resulted in an error message about the libibus package:
 warning: could not fully load metadata for package libibus-1.5.26-2 error: failed to prepare transaction (invalid or corrupted package)
 Fun. I first wanted to see if it was really just this package that was causing the problem or if there were other issues." />
<meta property="og:url" content="https://looped.network/posts/manjaro-invalid-corrupt-package/" />
<meta property="og:site_name" content="LoopedNetwork" />

  
    <meta property="og:image" content="https://looped.network/favicon.ico">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2022-09-17 18:30:30 -0400 EDT" />












</head>
<body class="pink">


<div class="container headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    LoopedNetwork
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://looped.network/posts/manjaro-invalid-corrupt-package/">Fixing Manjaro Linux Invalid Or Corrupt Package Error</a>
  </h1>
  <div class="post-meta">
    
      <time class="post-date">
        2022-09-17 ::
        
      </time>
    
    
    
      <span class="post-reading-time">:: 4 min read (711 words)</span>
    
  </div>

  
    <span class="post-tags">
      
      #<a href="https://looped.network/tags/manjaro/">Manjaro</a>&nbsp;
      
      #<a href="https://looped.network/tags/linux/">Linux</a>&nbsp;
      
      #<a href="https://looped.network/tags/corrupt/">Corrupt</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>As the title alludes to, this morning I tried updating my <a href="https://www.pine64.org/pinebook-pro/">Pinebook Pro</a> running Manjaro Linux through my normal method:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo pacman -Syu
</span></span></code></pre></div><p>Today, this resulted in an error message about the <code>libibus</code> package:</p>
<blockquote>
<p>warning: could not fully load metadata for package libibus-1.5.26-2
error: failed to prepare transaction (invalid or corrupted package)</p>
</blockquote>
<p>Fun. I first wanted to see if it was really <em>just</em> this package that was causing the problem or if there were other issues. Being a <code>pacman</code> noob, I just used the UI to mark updates to the <code>libibus</code> package as ignored. Once I did that, all of the other packages installed successfully. This prompted for a reboot, which I gladly did since I figured I&rsquo;d see if that made any difference. Once my laptop was back up and running, though, executing <code>pacman -Syu</code> again still gave the same error related to <code>libibus</code>.</p>
<p>Some searches online showed that a mirror with a bad package could be the problem, so I updated my mirrors via:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo pacman-mirrors -f5
</span></span></code></pre></div><p>This didn&rsquo;t solve the problem, but the new mirror gave me a different error message:</p>
<blockquote>
<p>error: could not open file /var/lib/pacman/local/libibus-1.5.26-2/desc</p>
</blockquote>
<p>With some more searches online, I saw a few people on the Manjaro forums say that simply creating those files was enough to fix similar errors they had with other packages. Creating the file above just resulted in an error about a second file being missing, so I ultimately ended up running:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo touch /var/lib/pacman/local/libibus-1.5.26-2/desc
</span></span><span style="display:flex;"><span>sudo touch /var/lib/pacman/local/libibus-1.5.26-2/file
</span></span></code></pre></div><p>Now running an update allowed things to progress a little further, but I got a slew of errors complaining about <code>libibus</code> header files (<code>.h</code>) existing on the filesystem. My next less-than-well-thought-out idea was to just remove the package and try installing it fresh. I tried running:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo pacman -R libibus
</span></span></code></pre></div><p>Fortunately, Manjaro didn&rsquo;t let me do this by telling me that it was a dependency for <code>gnome-shell</code>. Yeah, removing that would&rsquo;ve been bad. It was back to searching online. The next tip I stumbled across was to try clearing the <code>pacman</code> cache and then install updates with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo pacman -Scc
</span></span><span style="display:flex;"><span>sudo pacman -Syyu
</span></span></code></pre></div><p>This unfortunately gave me the same error about the header files. However, the same <a href="https://forum.manjaro.org/t/cant-update-manjaro-invalid-or-corrupted-package/78802">forum thread</a> had another recommendation to run:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo pacman -Syyu --overwrite <span style="color:#e6db74">&#39;*&#39;</span>
</span></span></code></pre></div><p>Curious about exactly what this would do prior to running it, I checked out the <code>man</code> page for <code>pacman</code>:</p>
<blockquote>
<p>Bypass file conflict checks and overwrite conflicting files. If the package that is about to be installed contains files that are already installed and match glob, this option will cause all those files to be overwritten. Using &ndash;overwrite will not allow overwriting a directory with a file or installing packages with conflicting files and directories. Multiple patterns can be specified by separating them with a comma. May be specified multiple times. Patterns can be negated, such that files matching them will not be overwritten, by prefixing them with an exclamation mark. Subsequent matches will override previous ones. A leading literal exclamation mark or backslash needs to be escaped.</p>
</blockquote>
<p>I took this to mean that instead of complaining about the header files that already existed on the filesystem, it would simply overwrite them since my glob was just <code>*</code> to match <em>anything</em>. I ran this, and sure enough everything was fine.</p>
<p>I mainly run Manjaro on my Pinebook Pro just because it&rsquo;s such a first class citizen there with tons of support. It&rsquo;s now the default when new Pinebook devices ship; back when I got mine it was still coming with Debian, though I quickly moved it over after seeing how in love the community was with Manjaro. I do find that I run into more random issues like this on Manjaro than I do with Fedora on my other laptop or Debian on my servers, for example, and at times it can be a little frustrating. I didn&rsquo;t really want to spend a chunk of my Saturday morning troubleshooting this, for example. But while there seem to be more issues with Manjaro, the documentation and community are so good that usually after a little time digging in, the solution can always be found. I&rsquo;ve yet to run into any issue where the <a href="https://loopednetwork.medium.com/pop-os-upgrade-issues-e8bc95935ff8">current installation was a lost cause</a> forcing me to reinstall the operating system.</p>

      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="https://looped.network/posts/decreasing-domains/">
                <span class="button__icon">←</span>
                <span class="button__text">Decreasing Domains</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="https://looped.network/posts/ffmpeg-audio-from-video/">
                <span class="button__text">Extracting Audio From Video With FFmpeg</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2023 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
